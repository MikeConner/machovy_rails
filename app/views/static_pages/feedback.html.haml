= render :partial => 'shared/flash_messages'
.row-fluid
  .span9
    %h2 Feedback Forum
    %p Welcome to the Machovy Feedback Forum! If you have a customer service issue, question or general comment for Machovy staff, you can send us a direct message and we'll do our best to get back to you.
    %p If you have suggestions on how to make Machovy even better, you can submit an <b>Idea</b>. (You must sign in to submit an idea.)
    Now, we know you're a genius... but it's just possible someone else had the same idea. And maybe some people --
    even though they obviously know the best place for men's interest shopping -- might not be full-on geniuses in other areas.
    If so, feel free to (be)rate them. You can see the highest-rated ideas on the right. Will yours make the cut?
    %br/
    %h4 I need customer service, or have a question/general comment for Machovy staff.
    = form_tag make_comment_path, :method => :put do
      - if @anonymous
        = hidden_field_tag 'user', 'Anonymous'
      - else
        = hidden_field_tag 'user', current_user.email
      My name is
      - label_tag 'name'
      = text_field_tag 'name', nil, :maxlength => 16
      , and I have a
      - label_tag 'category'
      = select_tag 'category', options_for_select(@categories)
      %br/
      - label_tag 'comment'
      = text_area_tag 'comment', nil, :size => '60x4'    
      %br/
      = submit_tag 'Listen up!'
    - if !@anonymous
      %h4 Alert the patent office! I have an <em>Idea</em>.
      - @idea = current_user.ideas.build unless @idea
      = form_for @idea do |f|
        = render :partial => 'shared/error_messages', :locals => { :errors => @idea.errors, :name => 'Idea' }
        = f.hidden_field :user_id, :value => current_user.id
        = f.label :name, 'My name'
        %em (whatever you want displayed; we will not show your email)
        %br/
        = f.text_field :name, :maxlength => 16
        %br/
        = f.label :title, 'In a Nutshell'
        %br/
        = f.text_field :title, :maxlength => 40
        %br/
        = f.label :content, 'My idea in all its glory'
        %br/
        = f.text_area :content, :size => '60x4'
        %br/
        = f.submit 'Submit idea'
  .span3
    %h3 Top rated ideas
    - if 0 == @ideas.count
      %p We need some great ideas!
    - else
      = link_to 'Show All Ideas', ideas_path
      %br/
      - @ideas.each do |idea|
        = render :partial => 'shared/idea', :locals => { :idea => idea, :user => current_user }
